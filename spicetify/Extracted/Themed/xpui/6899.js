"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[6899],{9167:(e,t,n)=>{n.d(t,{A:()=>je});var a=n(30758),o=n(41978),c=n(89531),r=n(11877),i=n(74554),s=n(74946),l=n(39733),d=n(41331),u=n(45237),m=n(20633),h=n(69524),g=n(15231),x=n(81060),f=n(25244),j=n(3894),v=n(76355);const b=["Escape","ArrowDown","ArrowUp","Tab"],y=e=>b.includes(e);var R=n(96266),C=n(61869);const p=new R.l("searchConcertLocations","query","afde8f028ae24689fd30b335fb73ec3a33e39a5aa2551608064b5cd0d9e6f7b4",null);var w=n(65104),_=n(82535);const D="pdkMNbSQl8Yi5tl0iOF9",N="lbKmnVjXCdZ3kRBxjKQZ",k="VAJ54U4IyPKmKRWXweMn",L="r3oh3bOf2I7DZQEND5Uz",S="XwomR4z9c60ph1tYBcdm",I="bQATTxDxEbS7xXRsr_Mt",M="wFdZQwoko8rVRTLeFG5G",E="jcDbJiJUoAVWZ7h1Rhhy",B="UkSUgC7NQnYbptBJEAM9",Z="xfncDja0wZotJaVS3aq9",V="gJedMi0s8_RQ4d2aWYzI";var T=n(86070);const q=({onCancel:e,onChange:t,onBack:n,title:o,children:c})=>{const[r,s]=(0,_.x)("recent-locations",[]),[l,b]=(0,a.useState)(""),R=(0,w.W)(),q=(0,a.useRef)(null),A=(0,a.useRef)(null),O=(0,a.useRef)(-1),{data:F}=(U={query:l},(0,C.I)(p,U,z));var U,z;const H=(e=>"items"in(e?.concertLocations??{}))(F)?F.concertLocations.items:[];return(0,T.jsx)("div",{onKeyDown:e=>{const t=e.key;if(!y(t))return;e.preventDefault();const n=((e,t,n)=>{switch(n){case"ArrowDown":case"Tab":return Math.min(e+1,t);case"ArrowUp":return Math.max(e-1,-1);default:return e}})(O?.current??-1,H.length,t),a=q.current?.childNodes[n]?.firstChild;n>=0&&a instanceof HTMLButtonElement&&a.focus(),-1===n&&A.current?.focus(),O.current=n},"data-interaction-context":"location-selector",children:(0,T.jsx)(v.A,{isOpen:!0,onRequestClose:e,children:(0,T.jsxs)("section",{className:D,children:[n&&(0,T.jsx)("div",{className:L,children:(0,T.jsx)(u.H,{iconOnly:R?m.V:h.g,size:"small",onClick:n,"aria-label":d.Ru.get("navbar.go-back")})}),(0,T.jsx)("div",{className:k,children:(0,T.jsx)(u.H,{iconOnly:i.M,size:"small",onClick:e,"aria-label":d.Ru.get("close")})}),(0,T.jsxs)("div",{className:N,children:[(0,T.jsxs)("div",{className:S,children:[(0,T.jsx)(g.E,{as:"h3",variant:"bodyMediumBold",children:o??d.Ru.get("concert.location.search.header")}),(0,T.jsx)(x.E,{iconLeading:(0,T.jsx)(f.C,{}),children:(0,T.jsx)(j.Z,{placeholder:d.Ru.get("concert.location.search.placeholder"),onChange:e=>b(e.currentTarget.value),value:l,ref:A,autoFocus:!0})})]}),!l&&(0,T.jsx)(T.Fragment,{children:c}),l&&F?.concertLocations&&0===H.length&&(0,T.jsx)(g.E,{as:"p",variant:"bodyMedium",children:d.Ru.get("concert.error.no_locations_found_subtitle")}),l&&(0,T.jsx)("ol",{className:I,ref:q,children:H.map(((e,n)=>(0,T.jsx)("li",{children:(0,T.jsx)("button",{tabIndex:n+1,className:Z,onClick:()=>{const n={geonameId:Number(e.geonameId),name:e.name,country:e.country,geohash:e.geoHash};r.find((e=>e.geonameId===n.geonameId))||s([...r,n]),t(n)},children:[e.name,e.country].join(d.Ru.getSeparator())})},e.geonameId)))}),!!r?.length&&!l&&(0,T.jsxs)("div",{className:M,children:[(0,T.jsx)("div",{className:E,children:(0,T.jsx)(g.E,{as:"h3",variant:"bodyMediumBold",children:d.Ru.get("concert.location.search.recent")})}),(0,T.jsx)("ol",{children:r.map(((e,n)=>(0,T.jsxs)("li",{className:B,children:[(0,T.jsx)("button",{tabIndex:n+1,className:Z,onClick:()=>t({geonameId:Number(e.geonameId),name:e.name,country:e.country,geohash:e.geohash}),children:(0,T.jsx)("div",{className:V,children:[e.name,e.country].join(d.Ru.getSeparator())})}),(0,T.jsx)(u.H,{"aria-label":d.Ru.get("remove"),iconOnly:i.M,size:"small",onClick:t=>{t.stopPropagation(),s(r.filter((t=>t.geonameId!==e.geonameId)))}})]},e.geonameId)))})]})]})]})})})};var A=n(77674);const O=new R.l("saveLocation","mutation","5502351e9f201ae29014ca55d3b24b755ba261a1a9eb35fb498cb4c7df419353",null);var F=n(20769);const U="WZzy7tMC5xlIMwoZ32JU",z="LkdC_QJiLoD0OTOWnkJV",H="WqruN54NvYqlA2XlTJ0Z",W="GS4yLEr0XMj8kw2iMAd8",J="prICvcudVq_SL6dqkZBw",$="YLM_DWbpYGBpvqtDEhum",G="h8jjXJERT64OZi2sHCbi",K=(e,t)=>e(O,{geonameId:t}),Q=({onCancel:e,onSave:t,location:n,storeConcertLocation:o=K})=>{const[c,l]=(0,a.useState)(!1),[m,h]=(0,a.useState)(!1),{getGraphQLLoader:g}=(0,F.mv)(),x=g();return(0,T.jsx)("div",{onKeyDown:t=>{const n=t.key;y(n)&&"Escape"===n&&e()},"data-interaction-context":"location-selector",children:(0,T.jsx)(v.A,{isOpen:!0,onRequestClose:e,children:(0,T.jsxs)("section",{className:U,children:[(0,T.jsx)("div",{className:H,children:(0,T.jsx)(u.H,{iconOnly:i.M,size:"medium",onClick:e,"aria-label":d.Ru.get("close")})}),(0,T.jsxs)("div",{className:z,children:[(0,T.jsx)("div",{className:W,children:(0,T.jsx)(A.Z,{variant:"celloCanon",children:d.Ru.get("concerts.location.change.confirm",n.name)})}),(0,T.jsx)("div",{className:J,children:(0,T.jsx)(r.t,{size:"xlarge"})}),(0,T.jsx)("div",{className:$,children:(0,T.jsx)(A.Z,{semanticColor:"textSubdued",children:d.Ru.get("concerts.location.change.info")})}),(0,T.jsx)(s.$,{onClick:async()=>{l(!0),h(!1);try{const a=await o(x,String(n.geonameId));if(e=a?.data?.storeUserLocation,void 0===e||!("success"in e)||!0!==e.success)throw Error();t()}catch{h(!0),l(!1)}var e},disabled:c,children:d.Ru.get("concerts.location.change.button")}),m&&(0,T.jsx)("div",{className:G,children:(0,T.jsx)(A.Z,{semanticColor:"textWarning",children:d.Ru.get("concerts.location.change.error")})})]})]})})})};var P=n(76092),X=n(69170);const Y=()=>(0,T.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",children:(0,T.jsx)("path",{d:"M6.94875 9.48555V14.9935C6.94875 15.5494 7.42943 16 8.02239 16C8.42905 16 8.80081 15.7846 8.98268 15.4436L15.6347 2.9711L15.9539 2.07322C16.1803 1.43663 15.5343 0.830999 14.8552 1.0432L13.8975 1.34249L0.593494 7.57874C0.229762 7.74924 0 8.09776 0 8.47901C0 9.03491 0.480685 9.48555 1.07364 9.48555H6.94875Z",fill:"currentColor"})}),ee=new R.l("concertLocationsByLatLon","query","8a059d072a17a1199feb21fe846271f1680eda87010c832852ced0c55c6c7c96",null);var te=n(95168),ne=n(52833),ae=n(26205);const oe="LUZuAtOgmXbneOoxnP8P",ce="dIOLAcD26GH01pNjZHBL",re="tXNcvSNL8Kx6wKUOej2I",ie="GQeQjsi5dPF4PFO7BzvL",se=e=>{const[t,n]=(0,a.useState)(!1),[o,c]=(0,a.useState)(!1),r=(()=>{const e=ee,{name:t,sha256Hash:n}=e,o=(0,P.jE)(),{request:c}=(0,a.useContext)(te.j);return a=>o.ensureQueryData({queryFn:()=>(0,ne.c)(c,e,a),queryKey:[t,a,n]})})(),i=(0,ae.t)(e.spec);return(0,T.jsxs)(T.Fragment,{children:[t&&(0,T.jsx)("div",{children:d.Ru.get("concert.location.search.current_location.error")}),(0,T.jsx)("button",{ref:i,className:re,onClick:async()=>{c(!0),e.getCurrentPosition((async t=>{const a=await r({lat:t.coords.latitude,lon:t.coords.longitude});if(o=a?.data?.concertLocations,void 0===o||!("items"in o))return c(!1),n(!0);var o;const[i]=a.data.concertLocations.items;return e.onChange({geonameId:Number(i.geonameId),name:i.name})}))},children:(0,T.jsx)(g.E,{semanticColor:"textSubdued",className:ie,children:o?(0,T.jsx)(X.U,{}):(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(Y,{})," ",d.Ru.get("concert.location.search.current_location")]})})})]})},le=new R.l("userLocation","query","079939378ca79b67c6d047be9152ea940d21f10bbfa2f5d4cf4d8320d87774c2",null),de=(e,t)=>(0,C.I)(le,e,t),ue="Hj5kpRfIocJic5jcxsW_",me="aJduGcVsoCwJvV1jVqjl",he=({onClick:e})=>{const{data:t}=de({});return t?(0,T.jsxs)("div",{className:ue,children:[(0,T.jsxs)("div",{className:me,children:[(0,T.jsx)(r.t,{size:"small"}),(0,T.jsxs)("div",{children:[(0,T.jsx)(A.Z,{as:"div",semanticColor:"textPositive",variant:"ballad",children:t.me?.profile?.location?.name}),(0,T.jsx)(A.Z,{as:"div",semanticColor:"textSubdued",children:d.Ru.get("concerts.location.preferred")})]}),(0,T.jsx)(c.n,{onClick:e,size:"small",children:d.Ru.get("concerts.location.change")})]}),(0,T.jsx)(A.Z,{semanticColor:"textSubdued",variant:"finale",children:d.Ru.get("concerts.location.preferred.info")})]}):null};var ge=n(19019),xe=n(99559),fe=n(4139);const je=e=>{const{isAnonymous:t}=(0,o.d4)(xe.Ht),{data:n,invalidate:u}=de({}),m=n?.me?.profile?.location,[h,g]=(0,a.useState)(),{handleLocationChange:x,locationStr:f,headerSpec:j}=e,[v,b]=(0,a.useState)(e.isDialogDefaultOpen??!1),[y,R]=(0,a.useState)(e.dialog??"browse"),[C,p]=(0,a.useState)();(0,a.useEffect)((()=>{h||g(m?.name)}),[m?.name,g,h]);const w=(0,a.useMemo)((()=>j?.changeLocationButtonFactory()),[j]),_=(0,a.useMemo)((()=>j?.changeLocationUiFactory({identifier:f})),[j,f]),D=(0,a.useMemo)((()=>_&&"currentLocationButtonFactory"in _?_?.currentLocationButtonFactory():void 0),[_]),N=(0,fe.s)(),k=(0,l.NC)(ge.tE2),L=()=>{w&&!v&&N.logInteraction(w.hitUiReveal()),b(!v)},S=()=>{b(!1),R(e.dialog??"browse"),p(void 0)},I=e=>{x(e),S()},M=void 0!==h&&e.locationStr!==d.Ru.get("concerts.default_location")&&h!==e.locationStr;h!==m?.name&&e.locationStr===m?.name&&g(m.name);const E=M?(0,T.jsxs)("div",{className:ce,children:[m&&(0,T.jsx)(c.n,{size:"small",iconOnly:i.M,"aria-label":d.Ru.get("close"),onClick:()=>x({geonameId:Number(m.geonameId),name:m.name})}),(0,T.jsx)(s.$,{size:"small",iconTrailing:i.M,onClick:()=>b(!0),children:f})]}):(0,T.jsx)(c.n,{iconLeading:r.t,onClick:L,size:"small",children:f}),B=e.action?(0,a.cloneElement)(e.action,{onClick:L}):E;return(0,T.jsxs)("div",{className:oe,children:[B,v&&"browse"===y&&(0,T.jsx)(q,{title:d.Ru.get("concert.location.search.header"),onChange:I,onCancel:S,spec:_,children:!t&&(0,T.jsx)(he,{onClick:()=>R("preferred")})}),v&&"preferred"===y&&(0,T.jsx)(q,{title:d.Ru.get("concerts.location.preferred"),onChange:e=>{R("confirm"),p(e)},onCancel:S,onBack:e.dialog?void 0:()=>R("browse"),spec:_,children:k&&"geolocation"in navigator&&(0,T.jsx)(se,{spec:D,getCurrentPosition:navigator.geolocation.getCurrentPosition.bind(navigator.geolocation),onChange:e=>{D?.hitUiReveal(),R("confirm"),p(e)}})}),v&&"confirm"===y&&C&&(0,T.jsx)(Q,{location:C,onCancel:S,onSave:async()=>{g(void 0),await u(),I(C)}})]})}},95884:(e,t,n)=>{n.d(t,{k:()=>x});var a=n(15231),o=n(74946),c=n(93813),r=n(41331),i=n(9167),s=n(96266),l=n(61869);const d=new s.l("inferredUserLocation","query","5db4c507ea735d2a1f37bd1166eca2c1a0e3387bb875ebca5d6031b6eccceeba",null);var u=n(26205),m=n(78487);const h="g8vV54lx3mRkeseb5Bf2";var g=n(86070);const x=e=>{const{data:t}=(n={},(0,l.I)(d,n,s));var n,s;const{spec:x}=(0,m.r)(c.F,{}),f=(0,u.t)(x);return t&&t.me?.profile?.location?.isInferred?(0,g.jsxs)("div",{className:h,ref:f,children:[(0,g.jsx)(a.E,{as:"h2",variant:"titleSmall",semanticColor:"textBase",children:r.Ru.get("concert.feed.set_location")}),(0,g.jsx)(a.E,{paddingBottom:"tighter-2",children:r.Ru.get("concert.feed.set_location_description")}),(0,g.jsx)(i.A,{locationStr:"london",dialog:"preferred",headerSpec:x,handleLocationChange:e.onLocationChange,action:(0,g.jsx)(o.$,{children:r.Ru.get("concert.feed.set_location_button")})})]}):null}},70707:(e,t,n)=>{n.d(t,{A:()=>j});var a=n(30758),o=n(15231),c=n(78768),r=n(91360),i=n(58708);const s="D_V60ibMxH9Vy7kyvWvc",l="anRK1X9LKn5HxZQJB5Tl",d="shUifmqVle_F5ILRpCqe",u="_WibGTg4OzGdsTf18zK1",m="LHhL2094jqvK0MNwlGAu",h="yRQGIh3Y05BG51IHUW2b",g="fT86P9Div4C8GXI9hZ36",x="G8sU0RZZT_ZhaEv7B26V";var f=n(86070);const j=(0,a.memo)((({date:e,image:t,title:n,subTitle:a,dateRange:j,uri:v,onClick:b})=>{const y=e?(0,i.l4)(e):void 0;return(0,f.jsxs)(r.N,{to:v,className:s,"data-testid":"concert-row",onClick:b,children:[(0,f.jsx)("time",{dateTime:e,className:l,children:y&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(o.E,{as:"div",variant:"bodySmall",children:(0,i.tj)(y)}),(0,f.jsx)(o.E,{variant:"bodyMediumBold",children:(0,i.Py)(y)})]})}),t&&(0,f.jsx)(c._,{src:t,alt:"",role:"presentation",className:d}),(0,f.jsxs)("div",{className:m,children:[(0,f.jsxs)("div",{className:h,children:[(0,f.jsx)(o.E,{variant:"bodyMedium",className:u,children:n}),(0,f.jsx)(o.E,{variant:"bodySmall","data-testid":"event-venue",semanticColor:"textSubdued",children:a})]}),(0,f.jsx)(o.E,{as:"span",variant:"bodyMedium",semanticColor:"textSubdued",className:g,children:j}),(0,f.jsx)("div",{className:x,children:y&&(0,f.jsx)(o.E,{variant:"bodyMedium",semanticColor:"textSubdued",children:(0,i.WB)(y)})})]})]})}))},12692:(e,t,n)=>{n.d(t,{$V:()=>a,Bw:()=>s,dR:()=>r,eO:()=>i,se:()=>c,w1:()=>l,ys:()=>o});const a=e=>"data"in e&&Object.keys(e.data).length>0,o=e=>"concerts"in(e??{}),c=e=>null!=e,r=e=>"__typename"in e&&"AllEvents"===e.__typename,i=e=>"__typename"in e,s=e=>!!e&&"sections"in e,l=e=>"__typename"in e},58708:(e,t,n)=>{n.d(t,{Fn:()=>m,MW:()=>h,Py:()=>d,VJ:()=>u,Vi:()=>j,WB:()=>g,WZ:()=>x,Y:()=>i,dp:()=>s,l4:()=>r,m7:()=>f,tX:()=>b,tj:()=>l});var a=n(12058),o=n(41331),c=n(12692);const r=e=>new Date(e.substring(0,16)),i=e=>o.Ru.formatDate(e,{weekday:"short",month:"short",day:"numeric"}),s=e=>o.Ru.formatDate(e,{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"numeric"}),l=e=>o.Ru.formatDate(e,{month:"short"}),d=e=>o.Ru.formatDate(e,{day:"numeric"}),u=e=>o.Ru.formatDate(e,{weekday:"short"}),m=e=>o.Ru.formatDate(e,{month:"short",day:"numeric"}),h=e=>o.Ru.formatDate(e,{weekday:"short",hour:"numeric",minute:"numeric"}),g=e=>o.Ru.formatDate(e,{hour:"numeric",minute:"numeric"}),x=(e,t)=>{if(e.toDateString()===t.toDateString())return i(e);if(e.getMonth()===t.getMonth()){return`${o.Ru.formatDate(e,{day:"numeric",month:"short"})}–${o.Ru.formatDate(t,{day:"numeric"})}`}return`${o.Ru.formatDate(e,{day:"numeric",month:"short"})}–${o.Ru.formatDate(t,{day:"numeric",month:"short"})}`},f=e=>{if(!e)return!1;const t=new Date(e);return new Date>t},j=e=>{const[t]=e,n=e[e.length-1];return(0,c.$V)(t)&&(0,c.$V)(n)?{startDate:r(t.data.startDateIsoString),endDate:r(n.data.startDateIsoString)}:{startDate:new Date,endDate:new Date}},v={month:"short",day:"numeric"},b=e=>{if((0,a.r)(e.from,e.to))return o.Ru.formatDate(e.from,v);return`${o.Ru.formatDate(e.from,v)} - ${o.Ru.formatDate(e.to,v)}`}},82606:(e,t,n)=>{n.d(t,{Ac:()=>r,a9:()=>i,i3:()=>d,im:()=>l,re:()=>s,tI:()=>o});var a=n(41331);const o=(e,t,n)=>!!e&&(t||!n.length),c=e=>e.artists.map((e=>e.name)),r=e=>1===e.length?a.Ru.get("concert.header.upcoming_concert_title_1",...e):2===e.length?a.Ru.get("concert.header.upcoming_concert_title_2",...e):3===e.length?a.Ru.get("concert.header.upcoming_concert_title_3",...e):4===e.length?a.Ru.get("concert.header.upcoming_concert_title_4",...e):e.length>4?a.Ru.get("concert.header.upcoming_concert_title_more",...e):"",i=e=>{const t=c(e);return o(e.title,e.festival,t)?e.title:r(t)},s=e=>1===e.length?a.Ru.get("concert.header.entity_title_1",...e):2===e.length?a.Ru.get("concert.header.entity_title_2",...e):3===e.length?a.Ru.get("concert.header.entity_title_3",...e):4===e.length?a.Ru.get("concert.header.entity_title_4",...e):e.length>4?a.Ru.get("concert.header.entity_title_more",...e):"",l=({name:e,city:t,region:n,country:o})=>[e,t,n,o].filter((e=>!!e&&"unknown"!==e.toLowerCase())).join(a.Ru.getSeparator()),d=e=>{if(!e.artists||0===e.artists.items.length)return e.title;if(e.festival)return e.title;const t=e.artists.items.map((e=>e.profile.name));return s(t)}},64345:(e,t,n)=>{n.d(t,{gq:()=>c,K9:()=>o,zV:()=>r});var a=n(41331);const o=(e,t,n)=>e?a.Ru.get("concert.entity_metadata.title",e,t,n):"",c=e=>{if(!e)return"";return`${e} Tickets - ${(new Date).getFullYear()} Concert Tour Dates | Spotify`},r=e=>`Concert Tickets & Tour Dates for you${e?` in ${e}`:""} | Spotify`}}]);
//# sourceMappingURL=6899.js.map