"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[599,38],{72991:(e,a,t)=>{t.d(a,{U:()=>i});var s=t(41331),r=t(39503),o=t(31352),n=t(86070);const i=({menu:e,onClick:a,"aria-label":t})=>(0,n.jsx)(o.b,{menu:e,children:(0,n.jsx)(r.e,{size:r.M.xs,label:s.Ru.get("more"),ariaLabel:t,onClick:a})})},70038:(e,a,t)=>{t.r(a),t.d(a,{CtaButton:()=>l,default:()=>d});var s=t(74946),r=t(30758),o=t(78158),n=t(95404);var i=t(86070);const l=({"aria-label":e,backgroundColor:a,className:t,onClick:l,text:d})=>{const c=function(e){return(0,r.useMemo)((()=>{if(!e)return;const a=(0,o.mA)(e);return{...a,text:{...a.text,base:n.LLE}}}),[e])}(a);return(0,i.jsx)(s.$,{UNSAFE_colorSet:c,"aria-label":e||d,className:t,colorSet:"invertedLight","data-testid":"ad-cta-button",size:"small",onClick:e=>{e.stopPropagation(),l?.(e)},children:d})},d=l},74508:(e,a,t)=>{t.r(a),t.d(a,{HomeAdCard:()=>Fe,default:()=>De});var s=t(30758),r=t(97500),o=t.n(r),n=t(66371);const i={opacity:0,height:"0px"};function l({dismiss:e}){const[a,t]=(0,s.useState)(null),[r,o]=(0,s.useState)(0);(0,s.useEffect)((()=>{if(a){o(a.offsetHeight);const e=new ResizeObserver((()=>o(a.offsetHeight)));return e.observe(a),()=>e.disconnect()}return o(0),()=>{}}),[a]);const l=r?(e=>({opacity:1,height:`calc(${e}px + ${(0,n.po)("base")})`}))(r):i,d=(0,s.useRef)(null);return{setGridElement:t,shownHeight:r,transitionableStyles:l,containerRef:d,collapseHeightThenDismiss(){if(!d.current||!r)return void e();d.current.animate([l,i],{fill:"forwards",easing:"ease",duration:420}).onfinish=e}}}var d=t(59072),c=t(13910),u=t(41331),m=t(72991),y=t(70038),f=t(91360),h=t(86070);const x=({"aria-label":e,clickUrl:a,...t})=>(0,h.jsx)(f.N,{"aria-label":e,"data-testid":"ad-cta-button-link",to:a,children:(0,h.jsx)(y.CtaButton,{...t})});var v=t(71726),b=t(3785),g=t(42395),j=t(4924),k=t(99186),A=t(78330);const p=(0,s.memo)((function({onDismissAdClick:e}){return(0,h.jsx)(A.pZ,{value:"home-ad",children:(0,h.jsx)(j.W,{children:(0,h.jsx)(A.pZ,{value:"dismiss",children:(0,h.jsx)(k.D,{role:"menuitem",leadingIcon:(0,h.jsx)(g.P,{size:"small"}),"aria-label":u.Ru.get("ad-formats.context-menu.not-interested"),onClick:e,children:u.Ru.get("ad-formats.context-menu.not-interested")})})})})}));var P=t(20769),C=t(45168);const N="kvXKrQ08Ar7oAsMVJNOg",E="dBm03FPk9rHjecHq1Qnn",R=({className:e,homeAd:a,dismiss:t})=>{const s=(0,P.vh)(),r=(0,b.L)(),n=o()(N,e),{extractedHomeAdColor:[i]}=(0,v.bT)(),l=(0,C.A)((()=>{t(),r.log("collapsed",a),s.send((0,c.F)({ad_id:a.adId,advertiser:a.metadata.advertiser,creative_id:a.metadata.creative_id,event:"dislike_HPTO",format:(0,d.gh)(a.format),line_item_id:a.metadata.line_item_id}))})),y=(0,C.A)((()=>{r.log("clicked",a)})),f=a.metadata.buttonText||u.Ru.get("ad-formats.learnMore");return(0,h.jsxs)("div",{className:n,children:[a.clickthroughUrl&&(0,h.jsx)(x,{"aria-label":`${f}, link`,backgroundColor:i?.colorDark,className:E,clickUrl:a.clickthroughUrl,onClick:y,text:f}),(0,h.jsx)(m.U,{"aria-label":"More options, button",menu:(0,h.jsx)(p,{onDismissAdClick:l})})]})};var U=t(15231);const S="lscHwwYXzt0CrEPAQgu3",_=({className:e,description:a,label:t,homeAd:s})=>{const r=o()(S,e),{clickthroughUrl:n,metadata:{tagline:i}}=s,l=(0,b.L)(),d=(0,C.A)((()=>{n&&l.log("clicked",s)}));return(0,h.jsxs)("div",{className:r,children:[t&&(0,h.jsx)(U.E,{variant:"bodyMedium",children:t}),i&&(0,h.jsx)(f.N,{to:n,onClick:d,"aria-label":`${i}, link`,children:(0,h.jsx)(U.E,{variant:"titleMedium",children:i})}),a&&(0,h.jsx)(U.E,{variant:"bodySmall",children:a})]})};var w=t(7008),M=t(87500),H=t(5052);const T="rLoSLtWsmOdhdiNz3r17",L=({className:e,homeAd:a})=>{const{metadata:{advertiser:t,logoImage:s},clickthroughUrl:r}=a,n=(0,b.L)(),i=(0,C.A)((()=>{r&&n.log("clicked",a)}));return(0,h.jsx)(f.N,{"aria-label":`${t}, Advertisement, link`,className:o()(e,T),to:r,onClick:i,children:(0,h.jsx)(w.v,{id:"advertiser-info",isInteractive:!1,media:s,padding:"0",subtitle:(0,h.jsx)(M.j,{children:u.Ru.get("ad-formats.advertisement")}),title:(0,h.jsx)(H.d,{children:t})})})};var V=t(1133),z=t(81054);const O="acMBKZuLlROUat0sL2a_",F=({className:e,icon:a,...t})=>(0,h.jsx)("div",{className:o()(O,e),...t,children:a});function D(e){const{imageUrlToExtractHomeAdColorFrom:[,a]}=(0,v.bT)();(0,s.useEffect)((()=>a(e)),[e,a]),(0,s.useEffect)((()=>()=>a(void 0)),[a])}var I=t(59677);function B(e){for(const{imageFileId:a,url:t}of e.display){if(a){const e=(0,I.CC)(a).toURI();if(e)return e}if(t)return t}}var W=t(65968);const q="lNTmTLY8RhoIIjrz4eyI",X=({className:e,displayAssetUrl:a,homeAd:t})=>{const r=(0,b.L)(),o=(0,C.A)((()=>{r.log("viewed",t)})),n=(0,C.A)((()=>{r.log("clicked",t)}));return(0,s.useEffect)((()=>o()),[o]),(0,h.jsx)(f.N,{to:t.clickthroughUrl,className:e,onClick:n,children:(0,h.jsx)(W._,{className:q,testid:"home-ad-display-asset",loading:"lazy",src:a,children:(0,h.jsx)(F,{icon:(0,h.jsx)(V.b,{})})})})},$=({className:e,homeAd:a})=>{const t=(0,s.useMemo)((()=>B(a)),[a]);return D(t),t?(0,h.jsx)(X,{className:e,homeAd:a,displayAssetUrl:t}):(0,h.jsx)(F,{className:e,icon:(0,h.jsx)(z.c,{size:"large"}),"data-testid":"home-ad-display-asset-fallback"})};var G=t(70873);const J="JS7sJfGVY9xjxR3eWJVq",Y=(0,s.memo)((({homeVideoAd:e})=>{const a=(0,s.useMemo)((()=>B(e)),[e]);return a?(0,h.jsx)(X,{className:J,displayAssetUrl:a,homeAd:e}):(0,h.jsx)(F,{className:J,icon:(0,h.jsx)(V.b,{})})}));var Z=t(14503);var Q=t(85130);var K=t(49151),ee=t(82387);const ae=s.useState;var te=t(35381);var se=t(74946),re=t(87867),oe=t(90077),ne=t(26574),ie=t(40152),le=t(69180);const de="oedSb2mjjyBaeN9twoSA",ce="FLXTIzOmNsF6knFRXaZS",ue="GJ9evYudn2W7Lr5yMA5i",me="EjfHeXS7GNvs18SAYXe2",ye=({betamaxPlayer:e,muted:a,paused:t,isContextPlayerVideoPlaying:s,isContextPlayerPlaybackPaused:r})=>{const o=(0,le.z)();return(0,h.jsxs)("div",{className:de,children:[(0,h.jsx)("div",{className:ue,children:a?(0,h.jsx)(se.$,{"aria-label":"Unmute, button",colorSet:"overMedia",iconOnly:re.X,onClick:()=>{e.setAudioDisabled(!1),!o.getState()?.item||s||r||o.pause()},size:"small"}):(0,h.jsx)(se.$,{"aria-label":"Mute, button",colorSet:"overMedia",iconOnly:oe.z,onClick:()=>e.setAudioDisabled(!0),size:"small"})}),(0,h.jsx)("div",{className:me,children:t?(0,h.jsx)(se.$,{"aria-label":"Play, button",colorSet:"overMedia",iconOnly:ne.A,onClick:()=>{e.resume(),o.getState()?.item&&s&&!r&&o.pause()},size:"medium"}):(0,h.jsx)(se.$,{"aria-label":"Pause, button",className:ce,colorSet:"overMedia",iconOnly:ie._,onClick:()=>e.pause(),size:"medium"})})]})};var fe=t(26864),he=t(17199),xe=t(83812);function ve(e,a,t){return new fe.A({mediaExtensions:[new he.h(e)],factories:[t]}).createBetamaxPlayer({videoElementConfig:{controls:!1,loop:!0},containerElement:a,networkConfiguration:{getAuthorizationHeader:async()=>{const{accessToken:e,tokenType:a}=await xe.l.get("sp://oauth/v2/token");return`${a} ${e}`}}})}async function be(e,{mediaUrl:a,playback_id:t,playWhenReady:s}){return await e.play({mediaUrl:a,isRoyaltyMedia:!1,metadata:{playback_id:t}},{playWhenReady:s})}var ge=t(48561);const je="WJllnHWGxXydlZGNRZiO",ke="r0vbWTxR_IGYTZyvgFMh",Ae=({assetUrl:e,homeVideoAd:a,videoContainerElement:t,createVideoPlayer:r=ve,playVideoPlayer:o=be})=>{const{betamaxPlayer:n,setBetamaxPlayer:i}=function(){const[e,a]=ae((()=>Promise.resolve(void 0)));return{betamaxPlayer:e,setBetamaxPlayer:a}}(),l=(0,b.L)(),{isContextPlayerVideoPlaying:d,isContextPlayerPlaybackPaused:c}={isContextPlayerVideoPlaying:(0,K.o)(ee.A3),isContextPlayerPlaybackPaused:(0,K.o)((e=>e?.isPaused))},u=!d||c,{muted:m,paused:y,loading:f,errored:x=!0,observerFactory:v}=function(e,a,t){const[r,o]=(0,s.useState)(!0),[n,i]=(0,s.useState)(!t),[l,d]=(0,s.useState)(!0),[c,u]=(0,s.useState)(!1);return{muted:r,paused:n,loading:l,errored:c,observerFactory:(0,s.useCallback)((()=>{let t=0;const s=(e,t)=>{a.log(e,t)},r=(e,a)=>{const r=(e=>{switch(e){case"started":return 1;case"first_quartile":return 2;case"midpoint":return 3;case"third_quartile":return 4;case"ended":case"error":return 5;default:return null}})(e);r?r>t&&(t=r,s(e,a)):s(e,a)};return{onStarted(){r("viewed",e),r("started",e),i(!1)},onResumed(){i((a=>(a&&r("resumed",e),!1)))},onPaused(){i(!0),r("paused",e)},onVolumeChanged({volume:a}){const t=a<=0;o(t),r(t?"muted":"unmuted",e)},onPlaybackCreated({timeObservable:a}){a.addObserverForMediaPositions([.25,.5,.75],(a=>{a>=.25&&r("first_quartile",e),a>=.5&&r("midpoint",e),a>=.75&&r("third_quartile",e)}))},onPlaybackEnded({reason:a}){switch(a){case te.mT.FATAL_ERROR:case te.mT.NETWORK_ERROR:r("error",e);break;case te.mT.PLAYED_TO_END:r("ended",e)}},onReady(){d(!1)},onPlaybackError(){d(!1),u(!0)}}}),[e,a])}}(a,l,u),g=(0,s.useMemo)((()=>(0,ge.U5)((0,ge.sH)(a.adId))),[a.adId]),j=function({assetUrl:e,createVideoPlayer:a,playVideoPlayer:t,observerFactory:s,playback_id:r,playWhenReady:o,muted:n}){return(0,C.A)((async({videoContainerElement:i,"video-manifest-url":l})=>{try{return await t(a(l,i,s).setAudioDisabled(n),{mediaUrl:e,playback_id:r,playWhenReady:o})}catch(e){return}}))}({assetUrl:e,createVideoPlayer:r,playVideoPlayer:o,observerFactory:v,playback_id:g,playWhenReady:u,muted:m});return function({videoContainerElement:e,initializeBetamaxPlayer:a,setBetamaxPlayer:t}){const r=(0,Z.g)(),o=(0,s.useRef)(),n=(0,s.useRef)();(0,s.useEffect)((()=>{const s=r.getValues();o.current=s;const i=s.then((t=>{if(s===o.current){const s=t["video-manifest-url"];if(s)return a({videoContainerElement:e,"video-manifest-url":s})}}));n.current=i,t(i),i.then((e=>{i===n.current&&t(e)}))}),[a,e,t,r])}({videoContainerElement:t,initializeBetamaxPlayer:j,setBetamaxPlayer:i}),function({betamaxPlayer:e,assetUrl:a,playVideoPlayer:t,playback_id:r,playWhenReady:o}){const n=(0,C.A)((async a=>{e instanceof Q.M&&await t(e,{mediaUrl:a,playback_id:r,playWhenReady:o})}));(0,s.useEffect)((()=>{n(a)}),[a,n])}({betamaxPlayer:n,assetUrl:e,playVideoPlayer:o,playback_id:g,playWhenReady:u}),((e,a,t=!1)=>{(0,s.useEffect)((()=>{e instanceof Q.M&&!t&&(a?e.pause():e.setAudioDisabled(!0))}),[t,a,e])})(n,d,c),function({betamaxPlayer:e}){(0,s.useEffect)((()=>e&&e instanceof Q.M?()=>{e.release()}:void 0),[e])}({betamaxPlayer:n}),f||n&&"then"in n?(0,h.jsx)(F,{className:J,icon:(0,h.jsx)(G.a3,{"aria-label":"Loading"})}):x||!n?(0,h.jsx)(Y,{homeVideoAd:a}):(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{className:ke}),(0,h.jsx)(ye,{betamaxPlayer:n,muted:m,paused:y,isContextPlayerVideoPlaying:d,isContextPlayerPlaybackPaused:c})]})},pe=({assetUrl:e,className:a,homeVideoAd:t})=>{const[r,n]=(0,s.useState)(null);return D((0,s.useMemo)((()=>t.metadata.logoImage||B(t)),[t])),(0,h.jsx)("div",{"data-testid":"home-ad-video-asset",className:o()(je,a),ref:n,children:r&&(0,h.jsx)(Ae,{homeVideoAd:t,assetUrl:e,videoContainerElement:r})})};var Pe=t(27099);var Ce=t(35369),Ne=t(61626);function Ee({extractedHomeAdColor:e}){const{extractedHomeAdColor:[,a]}=(0,v.bT)();return(0,s.useEffect)((()=>a(e)),[e,a]),(0,s.useEffect)((()=>()=>a(void 0)),[a]),(0,Ce.z)(e.colorRaw),null}function Re(){const{imageUrlToExtractHomeAdColorFrom:[e]}=(0,v.bT)(),a=(0,Ne.r)(e);return a?(0,h.jsx)(Ee,{extractedHomeAdColor:a}):null}var Ue=t(54347),Se=t(4391);const _e="gPtBODu_UjOYUZsXyVaw",we="OMnQ68kGUatqLnLhldea",Me="_lLWlErI3PPEoJh7DpgQ",He="qwCxwlFGiJwd7y757EIC",Te="n2TcVzKfe8w5qBzk_mHR",Le="iBi4L8rZvqCYwumUXiyQ",Ve="BbCl59l9jseBESAVkMFS",ze="_7BNL4Ovo2FE4OHUXD3b",Oe=(0,Ue.H)((({homeAd:e,dismiss:a},t)=>{const r=(0,s.useMemo)((()=>{if(a=e,(0,d.pq)(a.format)===d.nM.VIDEO){const a=function(e){for(const{videoManifestId:a,url:t}of e.video){if(a){const e=Pe.DJ.create(a);if(e)return e}if(t)return t}}(e);if(a)return{homeAd:e,videoAssetUrl:a}}var a}),[e]),{setGridElement:n,shownHeight:i,transitionableStyles:c,containerRef:u,collapseHeightThenDismiss:m}=l({dismiss:a});return(0,h.jsxs)("div",{className:_e,style:c,ref:e=>{u.current=e,"function"==typeof t?t(e):t&&(t.current=e)},"data-testid":"home-ad-card",children:[i&&(0,h.jsx)(Re,{}),(0,h.jsx)("div",{className:o()(we,{[Me]:(0,Se.A)()}),children:(0,h.jsxs)("div",{className:He,ref:n,children:[r?(0,h.jsx)(pe,{className:Te,homeVideoAd:r.homeAd,assetUrl:r.videoAssetUrl}):(0,h.jsx)($,{className:Te,homeAd:e}),(0,h.jsx)(L,{className:Le,homeAd:e}),(0,h.jsx)(_,{className:Ve,homeAd:e}),(0,h.jsx)(R,{className:ze,dismiss:m,homeAd:e})]})})]})})),Fe=(0,Ue.H)((({homeAd:e},a)=>{const{dismissed:t,dismiss:s}=(0,v.bT)();return t?null:(0,h.jsx)(Oe,{homeAd:e,dismiss:s,ref:a})})),De=Fe},3785:(e,a,t)=>{t.d(a,{L:()=>r});var s=t(71726);const r=()=>{const{logger:e}=(0,s.bT)();return e}},35369:(e,a,t)=>{t.d(a,{f:()=>i,z:()=>n});var s=t(30758),r=t(13390),o=t(53945);function n(e,a=r.l0o){const t=(0,o.as)();return(0,s.useEffect)((()=>(e&&t((0,o.Mo)(e)),()=>{t((0,o.Hf)())})),[e,t]),e||a}const i=({color:e,fallbackColor:a})=>(n(e,a),null)},61626:(e,a,t)=>{t.d(a,{r:()=>d,z:()=>c});var s=t(30758),r=t(13390),o=t(56629),n=t(17862),i=t(95168),l=t(2569);function d(e=null){const{request:a}=(0,s.useContext)(i.j),{data:t}=(0,l.I)({queryKey:["extracted-color",e],queryFn:()=>e?(0,n.j)(a,e).then((([{colorDark:e,colorLight:a,colorRaw:t}])=>({colorDark:e.toCSS(o.a.HEX),colorLight:a.toCSS(o.a.HEX),colorRaw:t.toCSS(o.a.HEX)}))):null,gcTime:864e5,staleTime:216e5,enabled:!!e});return t??void 0}function c(e=null,a=r.l0o,t="colorRaw"){return d(e)?.[t]??a}}}]);
//# sourceMappingURL=home-ad-card.js.map